{"ast":null,"code":"import { Platform, PlatformModule } from '@angular/cdk/platform';\nimport { InjectionToken, Directive, NgZone, ElementRef, Optional, Inject, PLATFORM_ID, Input, NgModule } from '@angular/core';\nimport { ANIMATION_MODULE_TYPE } from '@angular/platform-browser/animations';\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport * as ɵngcc0 from '@angular/core';\n\nclass NzWaveRenderer {\n  constructor(triggerElement, ngZone, insertExtraNode, platformId) {\n    this.triggerElement = triggerElement;\n    this.ngZone = ngZone;\n    this.insertExtraNode = insertExtraNode;\n    this.platformId = platformId;\n    this.waveTransitionDuration = 400;\n    this.styleForPseudo = null;\n    this.extraNode = null;\n    this.lastTime = 0;\n\n    this.onClick = event => {\n      if (!this.triggerElement || !this.triggerElement.getAttribute || this.triggerElement.getAttribute('disabled') || event.target.tagName === 'INPUT' || this.triggerElement.className.indexOf('disabled') >= 0) {\n        return;\n      }\n\n      this.fadeOutWave();\n    };\n\n    this.platform = new Platform(this.platformId);\n    this.clickHandler = this.onClick.bind(this);\n    this.bindTriggerEvent();\n  }\n\n  get waveAttributeName() {\n    return this.insertExtraNode ? 'ant-click-animating' : 'ant-click-animating-without-extra-node';\n  }\n\n  bindTriggerEvent() {\n    if (this.platform.isBrowser) {\n      this.ngZone.runOutsideAngular(() => {\n        this.removeTriggerEvent();\n\n        if (this.triggerElement) {\n          this.triggerElement.addEventListener('click', this.clickHandler, true);\n        }\n      });\n    }\n  }\n\n  removeTriggerEvent() {\n    if (this.triggerElement) {\n      this.triggerElement.removeEventListener('click', this.clickHandler, true);\n    }\n  }\n\n  removeStyleAndExtraNode() {\n    if (this.styleForPseudo && document.body.contains(this.styleForPseudo)) {\n      document.body.removeChild(this.styleForPseudo);\n      this.styleForPseudo = null;\n    }\n\n    if (this.insertExtraNode && this.triggerElement.contains(this.extraNode)) {\n      this.triggerElement.removeChild(this.extraNode);\n    }\n  }\n\n  destroy() {\n    this.removeTriggerEvent();\n    this.removeStyleAndExtraNode();\n  }\n\n  fadeOutWave() {\n    const node = this.triggerElement;\n    const waveColor = this.getWaveColor(node);\n    node.setAttribute(this.waveAttributeName, 'true');\n\n    if (Date.now() < this.lastTime + this.waveTransitionDuration) {\n      return;\n    }\n\n    if (this.isValidColor(waveColor)) {\n      if (!this.styleForPseudo) {\n        this.styleForPseudo = document.createElement('style');\n      }\n\n      this.styleForPseudo.innerHTML = `\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${waveColor};\n      }`;\n      document.body.appendChild(this.styleForPseudo);\n    }\n\n    if (this.insertExtraNode) {\n      if (!this.extraNode) {\n        this.extraNode = document.createElement('div');\n      }\n\n      this.extraNode.className = 'ant-click-animating-node';\n      node.appendChild(this.extraNode);\n    }\n\n    this.lastTime = Date.now();\n    this.runTimeoutOutsideZone(() => {\n      node.removeAttribute(this.waveAttributeName);\n      this.removeStyleAndExtraNode();\n    }, this.waveTransitionDuration);\n  }\n\n  isValidColor(color) {\n    return !!color && color !== '#ffffff' && color !== 'rgb(255, 255, 255)' && this.isNotGrey(color) && !/rgba\\(\\d*, \\d*, \\d*, 0\\)/.test(color) && color !== 'transparent';\n  }\n\n  isNotGrey(color) {\n    const match = color.match(/rgba?\\((\\d*), (\\d*), (\\d*)(, [\\.\\d]*)?\\)/);\n\n    if (match && match[1] && match[2] && match[3]) {\n      return !(match[1] === match[2] && match[2] === match[3]);\n    }\n\n    return true;\n  }\n\n  getWaveColor(node) {\n    const nodeStyle = getComputedStyle(node);\n    return nodeStyle.getPropertyValue('border-top-color') || // Firefox Compatible\n    nodeStyle.getPropertyValue('border-color') || nodeStyle.getPropertyValue('background-color');\n  }\n\n  runTimeoutOutsideZone(fn, delay) {\n    this.ngZone.runOutsideAngular(() => setTimeout(fn, delay));\n  }\n\n}\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n\nconst NZ_WAVE_GLOBAL_DEFAULT_CONFIG = {\n  disabled: false\n};\nconst NZ_WAVE_GLOBAL_CONFIG = new InjectionToken('nz-wave-global-options', {\n  providedIn: 'root',\n  factory: NZ_WAVE_GLOBAL_CONFIG_FACTORY\n});\n\nfunction NZ_WAVE_GLOBAL_CONFIG_FACTORY() {\n  return NZ_WAVE_GLOBAL_DEFAULT_CONFIG;\n}\n\nlet NzWaveDirective = /*#__PURE__*/(() => {\n  class NzWaveDirective {\n    constructor(ngZone, elementRef, config, animationType, platformId) {\n      this.ngZone = ngZone;\n      this.elementRef = elementRef;\n      this.config = config;\n      this.animationType = animationType;\n      this.platformId = platformId;\n      this.nzWaveExtraNode = false;\n      this.waveDisabled = false;\n      this.waveDisabled = this.isConfigDisabled();\n    }\n\n    get disabled() {\n      return this.waveDisabled;\n    }\n\n    get rendererRef() {\n      return this.waveRenderer;\n    }\n\n    isConfigDisabled() {\n      let disabled = false;\n\n      if (this.config && typeof this.config.disabled === 'boolean') {\n        disabled = this.config.disabled;\n      }\n\n      if (this.animationType === 'NoopAnimations') {\n        disabled = true;\n      }\n\n      return disabled;\n    }\n\n    ngOnDestroy() {\n      if (this.waveRenderer) {\n        this.waveRenderer.destroy();\n      }\n    }\n\n    ngOnInit() {\n      this.renderWaveIfEnabled();\n    }\n\n    renderWaveIfEnabled() {\n      if (!this.waveDisabled && this.elementRef.nativeElement) {\n        this.waveRenderer = new NzWaveRenderer(this.elementRef.nativeElement, this.ngZone, this.nzWaveExtraNode, this.platformId);\n      }\n    }\n\n    disable() {\n      this.waveDisabled = true;\n\n      if (this.waveRenderer) {\n        this.waveRenderer.removeTriggerEvent();\n        this.waveRenderer.removeStyleAndExtraNode();\n      }\n    }\n\n    enable() {\n      // config priority\n      this.waveDisabled = this.isConfigDisabled() || false;\n\n      if (this.waveRenderer) {\n        this.waveRenderer.bindTriggerEvent();\n      }\n    }\n\n  }\n\n  NzWaveDirective.ɵfac = function NzWaveDirective_Factory(t) {\n    return new (t || NzWaveDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(NZ_WAVE_GLOBAL_CONFIG, 8), ɵngcc0.ɵɵdirectiveInject(ANIMATION_MODULE_TYPE, 8), ɵngcc0.ɵɵdirectiveInject(PLATFORM_ID));\n  };\n\n  NzWaveDirective.ɵdir = /*@__PURE__*/ɵngcc0.ɵɵdefineDirective({\n    type: NzWaveDirective,\n    selectors: [[\"\", \"nz-wave\", \"\"], [\"button\", \"nz-button\", \"\", 3, \"nzType\", \"link\", 3, \"nzType\", \"text\"]],\n    inputs: {\n      nzWaveExtraNode: \"nzWaveExtraNode\"\n    },\n    exportAs: [\"nzWave\"]\n  });\n  return NzWaveDirective;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n\nlet NzWaveModule = /*#__PURE__*/(() => {\n  class NzWaveModule {}\n\n  NzWaveModule.ɵfac = function NzWaveModule_Factory(t) {\n    return new (t || NzWaveModule)();\n  };\n\n  NzWaveModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: NzWaveModule\n  });\n  NzWaveModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[PlatformModule]]\n  });\n  return NzWaveModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(NzWaveModule, {\n    declarations: function () {\n      return [NzWaveDirective];\n    },\n    imports: function () {\n      return [PlatformModule];\n    },\n    exports: function () {\n      return [NzWaveDirective];\n    }\n  });\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { NZ_WAVE_GLOBAL_CONFIG, NZ_WAVE_GLOBAL_CONFIG_FACTORY, NZ_WAVE_GLOBAL_DEFAULT_CONFIG, NzWaveDirective, NzWaveModule, NzWaveRenderer }; //# sourceMappingURL=ng-zorro-antd-core-wave.js.map","map":null,"metadata":{},"sourceType":"module"}